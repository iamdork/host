- include_vars: "{{file}}"

- user:
    name: "{{name}}"
    groups: dork,docker
    shell: /bin/zsh

- name: Install oh-my-zsh
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: /home/{{name}}/.oh-my-zsh
  become_user: "{{name}}"

- name: Install .zshrc
  template:
    src: dot_zshrc.j2
    dest: /home/{{name}}/.zshrc
  become_user: "{{name}}"

- copy:
    src: dot_zshrc.local
    force: no
    dest: /home/{{name}}/.zshrc.local

- name: Install amix/vimrc
  git:
    repo: https://github.com/amix/vimrc.git
    dest: /home/{{name}}/.vim_runtime
  become_user: "{{name}}"

- name: Install .vimrc
  template:
    src: dot_vimrc.j2
    dest: /home/{{name}}/.vimrc
  become_user: "{{name}}"

- copy:
    src: dot_vimrc.local
    force: no
    dest: /home/{{name}}/.vimrc.local

- authorized_key:
    user: "{{name}}"
    key: "{{key}}"
    state: present
  when: not blocked
  with_items: "{{public_keys}}"
  loop_control:
    loop_var: key

- authorized_key:
    user: "{{name}}"
    key: "{{key}}"
    state: absent
  when: blocked
  with_items: "{{public_keys}}"
  loop_control:
    loop_var: key



